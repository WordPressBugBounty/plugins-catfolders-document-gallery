(()=>{"use strict";const e=window.wp.blocks,l=window.React,t=window.wp.blockEditor,a=window.wp.element,n=window.wp.i18n;function o(){return(0,l.createElement)("div",{className:"block-spinner-wrap"},(0,l.createElement)("span",{className:"spinner is-active"}))}const c=(e,l)=>{const{limit:t}=e,a=l?Object.values(l):[],o=(l=>{let t;const a=l=>l.findIndex(l=>l.key===e.orderBy);return t=l.some(e=>"image"===e.key)?a(l):a(l)+1,t})(a),c=(e,l=[],t)=>{const a=[];return e.forEach((e,n)=>{"exclude"===t?!l.includes(e.key)&&a.push(n):l.includes(e.key)&&a.push(n)}),a},s=[];return a.forEach((e,l)=>{-1!==["image","link"].indexOf(e.key)&&s.push(l)}),{order:-1===o?[]:[o,e.orderType.toLowerCase()],columnDefs:[{type:"natural-nohtml",target:c(a,["size","updated"],"exclude")},{type:"file-size",targets:c(a,["size"],"include")},{orderable:!1,target:0!==s.length?s:[]},{searchable:!1,target:c(a,["link","image"],"include")},{type:"date-sort",targets:c(a,["updated"],"include")}],lengthMenu:[[t,2*t,4*t,8*t,-1],[t,2*t,4*t,8*t,(0,n.__)("All","catfolders-document-gallery")]],language:{searchPlaceholder:(0,n.__)("Search by title…","catfolders-document-gallery"),search:(0,n.__)("Search:","catfolders-document-gallery"),lengthMenu:`<span>${(0,n.__)("Items per page","catfolders-document-gallery")}</span> _MENU_`,info:"_START_ - _END_ "+(0,n.__)("of","catfolders-document-gallery")+" _TOTAL_",paginate:{next:'<svg width="8" height="14" viewBox="0 0 8 14" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1 1.5L6 7L1 12.5" stroke="currentColor" stroke-width="1.5"/></svg>',previous:'<svg width="8" height="14" viewBox="0 0 8 14" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7 1.5L2 7L7 12.5" stroke="currentColor" stroke-width="1.5"/></svg>'},aria:{sortAscending:(0,n.__)(": activate to sort column ascending","catfolders-document-gallery"),sortDescending:(0,n.__)(": activate to sort column descending","catfolders-document-gallery")}},pageLength:+t,autoWidth:!1,responsive:!0,sDom:r(e),drawCallback(l){const t=this.api().page.info().recordsTotal,a=jQuery(l.nTableWrapper).closest("#cf-app");!function(e,l,t=0){t<e.limit&&l.find(".cf-pagination").css("display","none"),e.libraryIcon.display?l.find(".cf-title img").css("display","block"):l.find(".cf-title img").css("display","none"),e.displayTitle?l.find(".cf-title span").css("display","block"):l.find(".cf-title span").css("display","none"),l.find(".cf-table__top").is(":empty")&&l.find(".cf-table__top").css("display","none"),l.find(".cf-table__bottom").is(":empty")&&l.find(".cf-table__bottom").css("display","none"),e.documentIcons.display?l.find(".cf-icon").removeClass("cf-hidden"):l.find(".cf-icon").addClass("cf-hidden"),e.displayColumns.image&&(l.find("th:first-child").addClass("cf-thumbnail-th"),l.find(".cf-table").addClass("cf-has-thumbnail"))}(e,a,t),y(a,e.displayColumns),u(l)}}},r=e=>{const l=e.searchBarPlacement,t=e.paginationPlacement,a=e.layoutIconPlacement;return'<"cf-table__top"'+("top"===l||"both"===l?"f":"")+("top"===a||"both"===a?' <"cf-options_info"l <"cf-options" <"cf-options__list"><"cf-options__grid">>>':"")+("top"===t||"both"===t?'<"cf-pagination" lip>':"")+'><"cf-table__main"rt><"cf-table__bottom"'+("bottom"===l||"both"===l?"f":"")+("bottom"===a||"both"===a?'<"cf-options_info"l <"cf-options" <"cf-options__list"><"cf-options__grid">>>':"")+("bottom"===t||"both"===t?'<"cf-pagination" lip>':"")+">"},s=(e,l)=>{const t=jQuery("#"+e).closest("#cf-app"),a=t.find(".cf-table"),n=t.find(".cf-options__grid"),o=t.find(".cf-options__list");"grid"===l?(n.addClass("active"),o.removeClass("active"),a.addClass("cf-table-grid"),a.find(".cf-column-thumbnail").length>0&&a.addClass("cf-has-thumbnail")):(o.addClass("active"),n.removeClass("active"),a.removeClass("cf-table-grid"),a.removeClass("cf-has-thumbnail"))},i=(e,l)=>{jQuery("#"+e).closest("#cf-app").find(".cf-title").replaceWith(function(){return jQuery(`<${l}>`,{class:"cf-title"}).html(jQuery(this).html())})},d=(e,l,t,a)=>{const o=jQuery("#"+e).closest("#cf-app");o.find(".btn-download img").remove(),o.find(".btn-download svg").remove(),"library"===l&&t&&""!==t?o.find(".btn-download").prepend(`<img src="${t}" alt="${(0,n.__)("Icon","catfolders-document-gallery")}">`):"custom"===l&&a&&o.find(".btn-download").prepend(a)},m=e=>{const l=jQuery("#"+e).closest("#cf-app");l.find(".cf-table-grid .cf-column-thumbnail").length>0?l.find(".cf-table").addClass("cf-has-thumbnail"):l.find(".cf-table").removeClass("cf-has-thumbnail")},u=e=>{jQuery.each(e.aoHeader,function(e,l){jQuery.each(l,function(e,l){if(l.cell.ariaLabel){const e=l.cell.ariaLabel.replace(/\s*:\s*/g,": ").trim();jQuery(l.cell).attr("aria-description",e),jQuery(l.cell).removeAttr("aria-label")}})})},f=e=>{const l=e.match(/<[^>]+>([^<]+)<\/[^>]+>/);return l?l[1].replace(/\t/g,"").toLowerCase():""},p=e=>{const l={xan:"Jan",feb:"Feb",mar:"Mar",abr:"Apr",mai:"May",xuñ:"Jun",xul:"Jul",ago:"Aug",set:"Sep",out:"Oct",nov:"Nov",dec:"Dec"};let t=e;if((document.documentElement.lang||"en-US").toLowerCase().startsWith("gl"))for(const[e,a]of Object.entries(l)){const l=new RegExp(`\\b${e}\\b`,"i");if(l.test(t)){t=t.replace(l,a);break}}return Date.parse(t)},g=(e,l,t)=>{const a=p(f(e)),n=p(f(l));switch(t){case"asc":return a<n?-1:a>n?1:0;case"desc":return a<n?1:a>n?-1:0}};function y(e,l){l.image?l.title||l.size||l.updated?(e.find("td:first-child").removeClass("no-margin-bottom"),e.find("td:first-child").addClass("has-margin-bottom"),e.find(".cf-column-last").removeClass("no-margin-top"),e.find(".cf-column-last").addClass("has-margin-top")):l.title||l.size||l.updated||(e.find("td:first-child").removeClass("has-margin-bottom"),e.find("td:first-child").addClass("no-margin-bottom"),e.find(".cf-column-last").removeClass("has-margin-top"),e.find(".cf-column-last").addClass("no-margin-top")):l.image||(l.title||l.size||l.updated)&&(e.find("td:first-child").removeClass("has-margin-bottom"),e.find("td:first-child").addClass("no-margin-bottom"),e.find(".cf-column-last").removeClass("no-margin-top"),e.find(".cf-column-last").addClass("has-margin-top"))}(0,n.__)("Thumbnail","catfolders-document-gallery"),(0,n.__)("Medium","catfolders-document-gallery"),(0,n.__)("Large","catfolders-document-gallery"),(0,n.__)("Full Size","catfolders-document-gallery");const b=[{value:"list",label:(0,n.__)("List","catfolders-document-gallery")},{value:"grid",label:(0,n.__)("Grid","catfolders-document-gallery")}],_=[{value:"title",label:(0,n.__)("Title","catfolders-document-gallery")},{value:"updated",label:(0,n.__)("Modified","catfolders-document-gallery")},{value:"size",label:(0,n.__)("Size","catfolders-document-gallery")},{value:"counter",label:(0,n.__)("Counter","catfolders-document-gallery")}],h=[{value:"ASC",label:(0,n.__)("Ascending","catfolders-document-gallery")},{value:"DESC",label:(0,n.__)("Descending","catfolders-document-gallery")}],v=[{value:"narrow",label:(0,n.__)("Narrow","catfolders-document-gallery")},{value:"all",label:(0,n.__)("All","catfolders-document-gallery")}],C=[{value:1,label:"1"},{value:2,label:"2"},{value:3,label:"3"},{value:4,label:"4"},{value:5,label:"5"},{value:6,label:"6"}],E=[{value:"image",label:(0,n.__)("Image","catfolders-document-gallery")},{value:"title",label:(0,n.__)("Title","catfolders-document-gallery")},{value:"type",label:(0,n.__)("Type","catfolders-document-gallery")},{value:"size",label:(0,n.__)("Size","catfolders-document-gallery")},{value:"updated",label:(0,n.__)("Updated","catfolders-document-gallery")},{value:"counter",label:(0,n.__)("Counter","catfolders-document-gallery")},{value:"link",label:(0,n.__)("Action","catfolders-document-gallery")}],w=[{value:"preview",label:(0,n.__)("Preview File","catfolders-document-gallery")},{value:"popup",label:(0,n.__)("Popup Window","catfolders-document-gallery")},{value:"download",label:(0,n.__)("Download File","catfolders-document-gallery")},{value:"",label:(0,n.__)("None","catfolders-document-gallery")}],I=[{value:"p",label:(0,n.__)("Paragraph","catfolders-document-gallery")},{value:"h1",label:(0,n.__)("Heading 1","catfolders-document-gallery")},{value:"h2",label:(0,n.__)("Heading 2","catfolders-document-gallery")},{value:"h3",label:(0,n.__)("Heading 3","catfolders-document-gallery")},{value:"h4",label:(0,n.__)("Heading 4","catfolders-document-gallery")}],x=[{value:"single_folder",label:(0,n.__)("Display as a single folder","catfolders-document-gallery")},{value:"hierarchical_folders",label:(0,n.__)("Display as hierarchical folders","catfolders-document-gallery")}],T=[{value:"top",label:(0,n.__)("Top","catfolders-document-gallery")},{value:"bottom",label:(0,n.__)("Bottom","catfolders-document-gallery")},{value:"both",label:(0,n.__)("Both","catfolders-document-gallery")},{value:"",label:(0,n.__)("Hide","catfolders-document-gallery")}],{PanelBody:N,RadioControl:k,SelectControl:M,RangeControl:j,ToggleControl:z}=wp.components;function S({attributes:e,setAttributes:o,clientId:c,setNotice:r,topRef:i}){const{libraryIcon:d,displayTitle:u,layout:f,gridColumn:p,displayColumns:g,searchBarPlacement:_,paginationPlacement:h,layoutIconPlacement:v,documentIcons:w}=e,[I,x]=(0,a.useState)(!1);(0,a.useEffect)(()=>{(()=>{const e=catf_dg.verify_imagick,l={...g};e.status||(l.image=!1,o({displayColumns:l})),x(e.status)})()},[]);return(0,l.createElement)(t.InspectorControls,null,(0,l.createElement)(N,{title:(0,n.__)("Display Options","catfolders-document-gallery"),initialOpen:!1},(0,l.createElement)("h3",null,(0,n.__)("Library Icon","catfolders-document-gallery")),(0,l.createElement)(z,{label:d.display?(0,n.__)("Show","catfolders-document-gallery"):(0,n.__)("Hide","catfolders-document-gallery"),checked:d.display,onChange:e=>{o({libraryIcon:{...d,display:e}}),((e,l)=>{const t=jQuery("#"+e).closest("#cf-app").find(".cf-title img");l?t.css("display","block"):t.css("display","none")})(c,e)}}),(0,l.createElement)("h3",null,(0,n.__)("Library Title","catfolders-document-gallery")),(0,l.createElement)(z,{label:u?(0,n.__)("Show","catfolders-document-gallery"):(0,n.__)("Hide","catfolders-document-gallery"),checked:u,onChange:e=>{o({displayTitle:e}),((e,l)=>{const t=jQuery("#"+e).closest("#cf-app").find(".cf-title span");l?t.css("display","block"):t.css("display","none")})(c,e)}}),(0,l.createElement)("h3",null,(0,n.__)("Document Icons","catfolders-document-gallery")),(0,l.createElement)(z,{label:w.display?(0,n.__)("Show","catfolders-document-gallery"):(0,n.__)("Hide","catfolders-document-gallery"),checked:w.display,onChange:e=>{o({documentIcons:{...w,display:e}}),((e,l)=>{const t=jQuery("#"+e).closest("#cf-app").find(".cf-icon");l?t.removeClass("cf-hidden"):t.addClass("cf-hidden"),m(e)})(c,e)}}),(0,l.createElement)(M,{label:(0,n.__)("Search Bar Placement","catfolders-document-gallery"),options:T,value:_,onChange:e=>o({searchBarPlacement:e})}),(0,l.createElement)(M,{label:(0,n.__)("Pagination Placement","catfolders-document-gallery"),options:T,value:h,onChange:e=>o({paginationPlacement:e})}),(0,l.createElement)(M,{label:(0,n.__)("Layout Icon Placement","catfolders-document-gallery"),options:T,value:v,onChange:e=>o({layoutIconPlacement:e})}),(0,l.createElement)(k,{label:(0,n.__)("Layout Display","catfolders-document-gallery"),onChange:e=>{o({layout:e}),s(c,e)},options:b,selected:f}),"grid"===f&&(0,l.createElement)(j,{label:"Column",allowReset:!0,resetFallbackValue:3,step:1,withInputField:!1,separatorType:"none",trackColor:"green",isShiftStepEnabled:!0,marks:C,railColor:"red",value:p,onChange:e=>o({gridColumn:e}),min:1,max:6}),(0,l.createElement)("h3",null,(0,n.__)("Display Fields","catfolders-document-gallery")),E.map(e=>(0,l.createElement)(z,{key:e.value,label:e.label,checked:g[e.value],onChange:l=>(async(e,l)=>{const t={...g};t[e]="image"===e?(e=>I?(r({imageColumnNotice:!1}),e):(i.current.scrollIntoView({top:0,left:0,behavior:"smooth"}),r({imageColumnNotice:!0}),!1))(l):l,await o({displayColumns:t}),y(jQuery("#"+c).closest("#cf-app"),t),m(c)})(e.value,l)}))))}const{PanelBody:L,TextControl:D,SelectControl:A,ToggleControl:Q,TextareaControl:O,Button:P}=wp.components;function B({attributes:e,setAttributes:a,clientId:o}){const{actionLabel:c,actionLink:r,actionColumnLabel:s,actionIconId:i,actionIconUrl:m,actionIconType:u,actionIconSvg:f}=e;return(0,l.createElement)(t.InspectorControls,null,(0,l.createElement)(L,{title:(0,n.__)("Action Options","catfolders-document-gallery"),initialOpen:!1},(0,l.createElement)(D,{disabled:!1,label:(0,n.__)("Column Label","catfolders-document-gallery"),value:s,onChange:e=>{a({actionColumnLabel:e})},name:"actionColumnLabel"}),(0,l.createElement)(D,{disabled:!1,label:(0,n.__)("Button Label","catfolders-document-gallery"),value:c,onChange:e=>{var l;a({actionLabel:e}),l=e,jQuery("#"+o).closest("#cf-app").find(".btn-download span").text(l)},name:"actionLabel"}),(0,l.createElement)(A,{label:(0,n.__)("Link To","catfolders-document-gallery"),value:r,onChange:e=>{a({actionLink:e})},options:w,name:"actionLink"}),(0,l.createElement)(Q,{label:(0,n.__)("Use Custom SVG Icon","catfolders-document-gallery"),checked:"custom"===u,onChange:e=>{a({actionIconType:e?"custom":"library"}),d(o,e?"custom":"library",m,f)},name:"actionIconType",help:"custom"===u?(0,n.__)("Enter your custom SVG code below","catfolders-document-gallery"):(0,n.__)("Select an icon from WordPress Media Library","catfolders-document-gallery")}),"custom"===u?(0,l.createElement)(O,{label:(0,n.__)("Custom SVG Code","catfolders-document-gallery"),value:f||"",onChange:e=>{a({actionIconSvg:e}),d(o,"custom",m,e)},name:"actionIconSvg",placeholder:(0,n.__)("Enter SVG code here...","catfolders-document-gallery"),help:(0,n.__)("Paste your SVG code here. Make sure it's valid SVG markup.","catfolders-document-gallery"),rows:6}):(0,l.createElement)("div",null,(0,l.createElement)("div",{style:{display:"block",marginBottom:"8px",fontWeight:"600",fontSize:"11px",lineHeight:"1.4",textTransform:"uppercase",color:"#1e1e1e"}},(0,n.__)("Icon","catfolders-document-gallery")),m?(0,l.createElement)("div",{style:{marginBottom:"12px"}},(0,l.createElement)("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px",border:"1px solid #ddd",borderRadius:"4px",backgroundColor:"#f9f9f9"}},(0,l.createElement)("img",{src:m,alt:(0,n.__)("Selected icon","catfolders-document-gallery"),style:{width:"40px",height:"40px",objectFit:"contain"}}),(0,l.createElement)("input",{type:"hidden",name:"actionIconId",value:i}),(0,l.createElement)("input",{type:"hidden",name:"actionIconUrl",value:m}),(0,l.createElement)(P,{variant:"secondary",isSmall:!0,onClick:()=>{a({actionIconId:null,actionIconUrl:null}),d(o,"library",null,null)},style:{color:"#d63638"}},(0,n.__)("Remove","catfolders-document-gallery")))):null,(0,l.createElement)(t.MediaUploadCheck,null,(0,l.createElement)(t.MediaUpload,{onSelect:e=>{a({actionIconId:e.id,actionIconUrl:e.url}),d(o,"library",e.url,null)},allowedTypes:["image"],value:i,render:({open:e})=>(0,l.createElement)(P,{variant:m?"secondary":"primary",onClick:e,style:{width:"100%"}},m?(0,n.__)("Change Icon","catfolders-document-gallery"):(0,n.__)("Select Icon from Media Library","catfolders-document-gallery"))})),(0,l.createElement)("p",{style:{fontSize:"12px",color:"#666",marginTop:"8px",marginBottom:"0"}},(0,n.__)("Choose an image from your WordPress Media Library to use as the action button icon.","catfolders-document-gallery")))))}const{SelectControl:H,Button:U}=wp.components,$=(0,a.memo)(({folders:e,treeOptions:t,setAttributes:a,libraryType:o})=>(0,l.createElement)(l.Fragment,null,t.length>0?(0,l.createElement)(H,{className:"catf-dg-select-wrapper",label:(0,n.__)("Folders","catfolders-document-gallery"),value:e,options:t,multiple:!0,onChange:e=>{a("hierarchical_folders"==o?{folders:[e[0]]}:{folders:e})},style:{height:200,overflow:"auto"}}):(0,l.createElement)(l.Fragment,null,(0,l.createElement)("p",null,(0,n.__)("Oops, you don't have any folder","catfolders-document-gallery")),(0,l.createElement)(U,{href:`${window.catfData.adminUrl}upload.php`,variant:"primary",target:"_blank",className:"catf-dg-create-folder-btn"},(0,n.__)("Create your first folder","catfolders-document-gallery"))))),{PanelBody:V,__experimentalNumberControl:F,RadioControl:R,SelectControl:W,TextControl:Y}=wp.components;function Z({attributes:e,setAttributes:a,clientId:o}){const{libraryIcon:c,title:r,displayTitle:s,titleTag:d,linkTo:m,popupWidth:u,popupHeight:f,limit:p,orderBy:g,orderType:y}=e;return(0,l.createElement)(t.InspectorControls,null,(0,l.createElement)(V,{title:(0,n.__)("General Options","catfolders-document-gallery")},(0,l.createElement)(Y,{disabled:!s,label:(0,n.__)("Library Title Text","catfolders-document-gallery"),value:r,onChange:e=>{a({title:e}),((e,l)=>{jQuery("#"+e).closest("#cf-app").find(".cf-title span")[0].innerHTML=l})(o,e)}}),(0,l.createElement)(W,{disabled:!s,label:(0,n.__)("Library Title Tag","catfolders-document-gallery"),value:d,onChange:e=>{a({titleTag:e}),i(o,e)},options:I}),(0,l.createElement)(Y,{disabled:!c.display,label:(0,n.__)("Library Icon Alt Text","catfolders-document-gallery"),value:c.altText,onChange:e=>{a({libraryIcon:{...c,altText:e}}),((e,l)=>{jQuery("#"+e).closest("#cf-app").find(".cf-title img")[0].setAttribute("alt",l)})(o,e)}}),(0,l.createElement)(W,{label:(0,n.__)("Link To","catfolders-document-gallery"),value:m,onChange:e=>{a({linkTo:e})},options:w}),"popup"===m&&(0,l.createElement)(l.Fragment,null,(0,l.createElement)(F,{className:"components-base-control",label:(0,n.__)("Popup Width","catfolders-document-gallery"),onChange:e=>{a({popupWidth:e})},min:100,max:2e3,shiftStep:5,step:1,value:u}),(0,l.createElement)(F,{className:"components-base-control",label:(0,n.__)("Popup Height","catfolders-document-gallery"),onChange:e=>{a({popupHeight:e})},min:100,max:2e3,shiftStep:5,step:1,value:f})),(0,l.createElement)(F,{className:"components-base-control",label:(0,n.__)("Limit items","catfolders-document-gallery"),onChange:e=>a({limit:+e}),min:1,max:200,shiftStep:5,step:1,value:p}),(0,l.createElement)(R,{label:(0,n.__)("Sort By","catfolders-document-gallery"),onChange:e=>{a({orderBy:e})},options:_,selected:g}),(0,l.createElement)(R,{label:(0,n.__)("Sort Type","catfolders-document-gallery"),onChange:e=>a({orderType:e}),options:h,selected:y})))}const G=e=>{const l=`#table-${e}`,t=(0,a.useRef)(null);return(0,a.useEffect)(()=>{jQuery.extend(jQuery.fn.dataTable.ext.type.order,{"date-sort-desc":(e,l)=>g(e,l,"desc")}),jQuery.extend(jQuery.fn.dataTable.ext.type.order,{"date-sort-asc":(e,l)=>g(e,l,"asc")})},[]),{createDataTable:function(a,o,r){jQuery.fn.DataTable.isDataTable(l)&&jQuery(l).DataTable().destroy();const{titleTag:d,displayColumns:m,layout:u}=a,f=c(a,r);f.columns=((e,l)=>{const{actionLabel:t,actionIconType:a,actionIconUrl:o,actionIconSvg:c}=l;let r="";return"library"===a&&o&&""!==o?r=`<img src="${o}" alt="${(0,n.__)("Icon","catfolders-document-gallery")}">`:"custom"===a&&c&&(r=c),[{data:"image",render:(e,l,t)=>`<div class="cf-column-thumbnail">${t.image}</div>`,visible:e.image,orderable:!1},{data:"title",render:(e,l,t)=>`<div class='flex'><a href="${t.url}" class="cf-icon icon-${(e=>["doc","jpg","mp4","other","pdf","ppt","wav","xls","zip"].includes(e)?e:["tif","tiff","jpeg","png","bmp","ithmb","gif","eps","raw","cr2","nef","orf","sr2","apng","avif","jfif","pjpeg","pjp","svg","ico","webp","psd","wbmp"].includes(e)?"jpg":["mp3","aac","aif","aifc","aiff","au","flac","m4a","mid","m4b","m4p","m4r","oga","ogg","opus","ra","ram","spx","wm"].includes(e)?"wav":["3gp","3gpp","3gpp2","3g2","asf","avi","dv","dvi","flv","m2t","m4v","mkv","mov","mpeg","mpg","mts","ogv","ogx","rm","rmvb","ts","vob","webm","wm"].includes(e)?"mp4":["pptx","ppthtml","pptm","pptxml","prn","ps","pps","ppsx","pwz","rtf","tab","template","tsv","vdx","vsd","vss","vst","vsx","vtx"].includes(e)?"ppt":["xlsx","csv","wpd","wps","xdp","xdf","xlam","xll","xlr","xlsb","xlsm","xltm","xltx","xps","wbk","wpd","wi"].includes(e)?"xls":["docx","dochtml","docm","docxml","odt","dot","dothtml","dotm","dotx","eps","fdf","key","keynote","kth","mpp","mpt","mpx","mpd"].includes(e)?"doc":["zip","rar","taz","gzip","tar.bz2","tar.gz"].includes(e)?"zip":"other")(t.type)}">${t.title}</a></div>`,visible:e.title},{data:"type",render:(e,l,t)=>`<div class='cf-column-type'>${t.type}</div>`,visible:e.type},{data:"size",render:(e,l,t)=>`<div class='cf-column-size'>${t.size}</div>`,visible:e.size},{data:"modified",render:(l,t,a)=>`<div class="${e.link?"cf-column-modified cf-column-link":"cf-column-modified"}">${a.modified}</div>`,visible:e.updated},{data:"counter",render:(e,l,t)=>`<div class="cf-download-count">${t.counter}</div>`,visible:e.counter},{data:"link",render:(e,l,a)=>`<div class='cf-column-last'><span class='cf-updated'><small>Updated</small>${a.modified}</span><a href="${a.link}" class="btn-download">${r}<span>${t}</span></a></div>`,visible:e.link,orderable:!1}]})(m,a),f.data=o,o&&(t.current=jQuery(l).DataTable(f),((e,l)=>{const t=jQuery("#"+e).closest("#cf-app");t.find(".cf-options__list").append('<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n    <rect width="20" height="4" rx="2" transform="matrix(-1 0 0 1 20 0)" fill="currentColor"/>\n    <rect width="20" height="4" rx="2" transform="matrix(-1 0 0 1 20 8)" fill="currentColor"/>\n    <rect width="20" height="4" rx="2" transform="matrix(-1 0 0 1 20 16)" fill="currentColor"/>\n  </svg>'),t.find(".cf-options__grid").append('<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M17.5 0C18.8807 0 20 1.11929 20 2.5V6.25C20 7.63071 18.8807 8.75 17.5 8.75H13.75C12.3693 8.75 11.25 7.63071 11.25 6.25V2.5C11.25 1.11929 12.3693 0 13.75 0H17.5Z" fill="currentColor"/>\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M6.25 0C7.63071 0 8.75 1.11929 8.75 2.5V6.25C8.75 7.63071 7.63071 8.75 6.25 8.75H2.5C1.11929 8.75 0 7.63071 0 6.25V2.5C0 1.11929 1.11929 0 2.5 0H6.25Z" fill="currentColor"/>\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M6.25 11.25C7.63071 11.25 8.75 12.3693 8.75 13.75V17.5C8.75 18.8807 7.63071 20 6.25 20H2.5C1.11929 20 0 18.8807 0 17.5V13.75C0 12.3693 1.11929 11.25 2.5 11.25H6.25Z" fill="currentColor"/>\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M17.5 11.25C18.8807 11.25 20 12.3693 20 13.75V17.5C20 18.8807 18.8807 20 17.5 20H13.75C12.3693 20 11.25 18.8807 11.25 17.5V13.75C11.25 12.3693 12.3693 11.25 13.75 11.25H17.5Z" fill="currentColor"/>\n  </svg>'),s(e,l)})(e,u),i(e,d))},dataTableRef:t}},J=async(e,l)=>{const t=catfData.apiSettings.rest_url,a=catfData.apiSettings.rest_nonce,o=await fetch(`${t}/${e}`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":a},body:JSON.stringify(l)}).then(e=>{if(e.ok)return e;throw new Error((0,n.__)("Network response was not ok.","catfolders-document-gallery"))});return await o.json()},{Placeholder:K,Icon:X}=wp.components,q=()=>(0,l.createElement)(K,{icon:(0,l.createElement)(X,{icon:"media-document"}),label:(0,n.__)("CatFolders Document Gallery","catfolders-document-gallery"),instructions:(0,n.__)("Select folders to show content here","catfolders-document-gallery")},(0,l.createElement)("div",{style:{backgroundColor:"#e7e7e7",width:"100%",padding:"30px",display:"flex",justifyContent:"center"}},(0,l.createElement)("div",null,(0,n.__)("Please select your folders that you want display","catfolders-document-gallery")))),{useState:ee,useEffect:le}=wp.element,te=({attributes:e,clientId:t,setAttributes:a})=>{const[o,c]=ee({}),{title:r,searchBarPlacement:s,paginationPlacement:i,layoutIconPlacement:m,displayColumns:u,folders:f,limit:p,orderBy:g,orderType:y,actionColumnLabel:b,actionLabel:_,actionLink:h,actionIconType:v,actionIconId:C,actionIconUrl:E,actionIconSvg:w}=e,{createDataTable:I,dataTableRef:x}=G(t),[T,N]=ee(!1);le(()=>{(async()=>{const l={folders:null!=f?f:[],currentPage:1,limit:p,displayColumns:e.displayColumns};"library"===v&&C&&(l.actionIconId=C);const t=await J("get-attachments-folders",l);t.actionIconUrl&&(a({actionIconUrl:t.actionIconUrl}),setTimeout(()=>{k(t.actionIconUrl)},300)),c(t)})()},[f,p]),le(()=>{N(!0)},[s,i,m]),le(()=>{I(e,o.files,o.columns),N(!1)},[o,T]),le(()=>{if(x.current)for(const[e,l]of Object.entries(u))x.current.column(Object.keys(u).findIndex(l=>l===e)).visible(l)},[u]),le(()=>{if(x.current){const e=Object.keys(u).findIndex(e=>e===g);x.current.order([e,y.toLowerCase()]).draw()}},[g,y]);const k=e=>{"library"===v&&C&&d(t,"library",e,null)};return(0,l.createElement)(l.Fragment,null,o.foundPosts?(0,l.createElement)("div",{id:"cf-app",className:"cf-app catFolder-addons-block-editor",style:{pointerEvents:"none"}},(0,l.createElement)("div",{"data-layout":e.layout,className:`cf-main ${t}`,id:`${t}`},(0,l.createElement)("div",{className:"container"},(0,l.createElement)("p",{className:"cf-title"},(0,l.createElement)("img",{src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDkiIGhlaWdodD0iMzgiIHZpZXdCb3g9IjAgMCA0OSAzOCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTQ0LjI0NTkgNC4yNjU1NEgyMi44MjY3QzIxLjcxMjEgNC4yNjU1NCAyMC42NDYgMy43ODYyNyAxOS45MTkxIDIuOTcxNUwxOC42MTA3IDEuNTMzNjhDMTcuNzM4NSAwLjUyNzIwMiAxNi40MyAwIDE1LjEyMTYgMEg1LjYyMzU2QzMuMDA2NzQgMCAwLjkyMjk3NCAyLjA2MDg4IDAuOTIyOTc0IDQuNjQ4OTZWMzIuMzk5QzAuOTIyOTc0IDM0LjkzOTEgMy4wMDY3NCAzNy4wNDc5IDUuNjIzNTYgMzcuMDQ3OUg0NC4yNDU5QzQ2LjgxNDIgMzcuMDQ3OSA0OC45NDY0IDM0Ljk4NyA0OC45NDY0IDMyLjM5OVY4LjkxNDUxQzQ4Ljk0NjQgNi4zNzQzNSA0Ni44NjI3IDQuMjY1NTQgNDQuMjQ1OSA0LjI2NTU0Wk00NC42ODIgMzIuNzgyNEg1LjE4NzQyVjguNDgzMTZINDQuNjMzNVYzMi44MzAzTDQ0LjY4MiAzMi43ODI0WiIgZmlsbD0iIzIyNzFCMSIvPgo8L3N2Zz4K",alt:"ico-folders"}),(0,l.createElement)("span",null,r)),(0,l.createElement)("div",{className:"cf-after-heading"},(0,l.createElement)(()=>{if("hierarchical_folders"==e.libraryType){let t=null,a=null;return e.showBreadCrumb&&(t=(0,l.createElement)("div",{dangerouslySetInnerHTML:{__html:o.breadcrumbHtml}})),e.isNestedFolders&&(a=(0,l.createElement)("div",{dangerouslySetInnerHTML:{__html:o.childrenHtml}})),(0,l.createElement)(l.Fragment,null,t,a)}return null},null)),(0,l.createElement)("table",{id:`table-${t}`,className:"cf-table",style:{"--grid-column":e.gridColumn}},(0,l.createElement)("thead",null,(0,l.createElement)("tr",null,(0,l.createElement)("th",null,(0,l.createElement)("span",null,(0,n.__)("Image","catfolders-document-gallery"))),(0,l.createElement)("th",{className:"cf-title-th"},(0,l.createElement)("span",null,(0,n.__)("Title","catfolders-document-gallery"))),(0,l.createElement)("th",null,(0,l.createElement)("span",null,(0,n.__)("Type","catfolders-document-gallery"))),(0,l.createElement)("th",null,(0,l.createElement)("span",null,(0,n.__)("Size","catfolders-document-gallery"))),(0,l.createElement)("th",null,(0,l.createElement)("span",null,(0,n.__)("Updated","catfolders-document-gallery"))),(0,l.createElement)("th",null,(0,l.createElement)("span",null,(0,n.__)("Counter","catfolders-document-gallery"))),(0,l.createElement)("th",null,(0,l.createElement)("span",null,b||(0,n.__)("Link","catfolders-document-gallery"))))))))):(0,l.createElement)(q,null))},ae=(e,l)=>{let t=[];return e.forEach(e=>{const a="-".repeat(l);t.push({...e,title:a+e.title}),e.children&&e.children.length&&(l++,t=t.concat(ae(e.children,l)),l--)}),[...t]},{Notice:ne,PanelBody:oe,SelectControl:ce,ToggleControl:re,RadioControl:se}=wp.components,ie=JSON.parse('{"UU":"catfolders/document-gallery"}');(0,e.registerBlockType)(ie.UU,{icon:{src:()=>(0,l.createElement)("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",enableBackground:"new 0 0 512 512"},(0,l.createElement)("g",null,(0,l.createElement)("g",null,(0,l.createElement)("path",{fill:"#EA60D5",d:"M402.6,247.3c-5.1-7.4-13.5-13.3-24.4-17.1c0,0,0,0,0,0c-5.6-1.9-12.5-2.7-21.2-2.6c-4.2,0.1-8.9,0.4-13.9,1 c-4.6,0.5-9.5,1.3-14.4,2.2c-4.8-4.7-9-9.3-12.8-13.8c-8.3-10-16.2-21.2-23.5-33.2c-1.4-2.3-2.6-4.3-3.6-6.2 c1.3-2.8,2.5-5.7,3.7-8.7c1.9-4.8,3.5-9.3,4.7-13.6c2.7-9.4,3.8-17,3.2-23.3c-2.1-24-15.9-39-34.4-37.4 c-18.5,1.6-29.5,18.8-27.4,42.8c0.5,5.9,2.6,12.5,6.3,20.4c1.8,3.8,4,7.9,6.6,12.3c2.4,4.1,5.1,8.3,8.1,12.6l-1.4,3.7 c-5,13-10.1,26.1-15.1,38.2l-3.1,7.5c-3.8,9.3-7.3,17.4-10.3,24.1l0,0c-4.2,0.7-8.6,1.7-13.1,2.7c-5,1.2-9.6,2.5-13.8,3.9 c-9.2,3.1-16.1,6.6-21,10.7c-18.4,15.5-22.8,35.4-10.9,49.6c5.7,6.8,13.3,10.1,21.7,10.1c9.3,0,19.5-4.1,29.1-12.2 c4.5-3.8,8.8-9.3,13.1-16.9c2.1-3.7,4.2-7.8,6.3-12.4c0.9-2,1.7-3.9,2.4-5.9l0.5-1.2c0.2-0.2,0.3-0.4,0.4-0.7l2.4-5 c18.3-5.8,37.5-11.1,57-15.6c6.1-1.4,11.7-2.7,17-3.8c2.1,2.3,4.2,4.7,6.5,7c3.6,3.6,7.1,6.9,10.5,9.8c7.4,6.3,14,10.4,20,12.5 c22.8,7.8,42.1,1.3,48.2-16.2C409.1,264.1,407.9,255,402.6,247.3z M369.9,254.1c6.4,2.2,9.5,4.6,10.9,6.2c2,2.3,1.5,3.7,1.4,4.2 c-0.2,0.5-0.7,1.9-3.7,2.5c-2.1,0.4-6,0.3-12.4-1.9c-1.7-0.6-5.4-2.4-11.9-7.8c-1.1-0.9-2.6-2.3-4.2-3.8c2.9-0.3,6-0.5,7.5-0.5 C362.9,252.8,367.4,253.2,369.9,254.1z M268.3,119.8c0.1,0,0.2,0,0.3,0c0.7,0,2,0.3,3.4,2.4c1.2,1.8,2.7,5.3,3.3,12.1 c0.2,1.7,0.1,5.9-2.3,14c-0.4,1.3-1.1,3.4-1.7,5.4c-1.4-2.6-2.9-5.2-3.5-6.6c-3.1-6.6-3.8-10.3-4-11.8 C263,126.3,264.8,120.1,268.3,119.8z M263.4,241.7l3.1-7.7c3.5-8.7,7.2-17.9,10.8-27.1c6.4,9.8,12.7,18.4,19.3,26.3 c1.4,1.7,2.9,3.4,4.3,5c-0.9,0.2-1.8,0.4-2.7,0.6c-11.7,2.7-24.1,6-37.7,9.9C261.4,246.5,262.4,244.2,263.4,241.7z M216.4,285.2 c-1.3,2.6-2.6,5.3-3.4,6.7c-2.7,4.7-5.3,8.3-7.4,10.1c-5.2,4.4-8.8,5.8-10.9,6.2c-3,0.6-4-0.6-4.3-1c-0.3-0.4-1.3-1.6-0.2-4.4 c0.8-2,2.8-5.3,8-9.7c1.3-1.1,4.8-3.4,12.8-6.1C212.3,286.4,214.3,285.8,216.4,285.2z M463.3,135.2c0.2-3.4-1-6.8-3.4-9.4 l-82.3-85.3c-2.3-2.3-5.3-3.5-8.4-3.7c-0.5-0.1-1-0.1-1.5-0.1H155.5c-25.8,0-46.8,21-46.8,46.8v25.3H83.5c-25.8,0-46.8,21-46.8,46.8 v261c0,25.8,21,46.8,46.8,46.8h261c25.8,0,46.8-21,46.8-46.8v-25.3h25.3c25.8,0,46.8-21,46.8-46.8V135.9c0,0,0,0,0,0v-0.4 C463.3,135.3,463.3,135.3,463.3,135.2z M381.1,80.4l40.2,41.6h-40.2V80.4z M366.1,416.5c0,11.9-9.7,21.7-21.7,21.7h-261 c-11.9,0-21.7-9.7-21.7-21.7v-261c0-11.9,9.7-21.7,21.7-21.7h25.3v210.6c0,25.8,21,46.8,46.8,46.8h210.6V416.5z M438.2,344.5 c0,11.9-9.7,21.7-21.7,21.7h-25.3h-25.1H155.5c-11.9,0-21.7-9.7-21.7-21.7V133.9v-25.1V83.5c0-11.9,9.7-21.7,21.7-21.7h200.4v48.4 v24.3c0,1,0.1,2,0.4,2.9c1,4,3.8,7.3,7.6,8.8c1.4,0.6,2.9,0.9,4.6,0.9h22h47.7V344.5z"}))))},edit:function({attributes:e,setAttributes:c,clientId:r}){const s=(0,t.useBlockProps)(),{treeOptions:i,getTreeOptions:d}=(()=>{const[e,l]=(0,a.useState)([]);return{treeOptions:e,getTreeOptions:async function(){const e=await J("get-all-tree-folders"),t=ae(e.tree,0).map(e=>({value:e.id,label:e.title}));l(t)}}})(),{folders:m,libraryType:u,showBreadCrumb:f,isNestedFolders:p,searchScope:g}=e,[y,b]=(0,a.useState)(!0),[_,h]=(0,a.useState)({imageColumnNotice:!1});(0,a.useEffect)(()=>{(async()=>{await d(),b(!1)})()},[]);const C=(0,a.useRef)(null);return(0,l.createElement)("div",{...s},(0,l.createElement)("div",{ref:C}),_.imageColumnNotice&&(0,l.createElement)(ne,{status:"warning",isDismissible:!0,className:"catf-config-notice",onRemove:()=>{h({imageColumnNotice:!1})}},catf_dg.verify_imagick.message,(0,l.createElement)("span",null," ",(0,l.createElement)("a",{href:catf_dg.verify_imagick.navigatePage.url,target:"_blank",rel:"noreferrer"},catf_dg.verify_imagick.navigatePage.content))),(0,l.createElement)(te,{attributes:e,clientId:r,setAttributes:c}),(0,l.createElement)(t.InspectorControls,null,(0,l.createElement)(oe,{initialOpen:!0,title:(0,n.__)("Folders","catfolders-document-gallery")},y?(0,l.createElement)(o,null):(0,l.createElement)(l.Fragment,null,(0,l.createElement)(ce,{label:(0,n.__)("Library Type","catfolders-document-gallery"),value:u,onChange:e=>{c({libraryType:e}),"hierarchical_folders"==e&&m.length>1&&c({folders:[m[0]]})},options:x}),"single_folder"==u&&(0,l.createElement)("p",null,(0,n.__)("You can select multiple folders in different levels. All files will be displayed all together in a single list.","catfolders-document-gallery")),"hierarchical_folders"==u&&(0,l.createElement)("p",null,(0,n.__)("You can select only one main folder. Its sub-folders will also be included in the folder tree. Your selected main folder will be the root folder.","catfolders-document-gallery")),(0,l.createElement)($,{folders:m,treeOptions:i,setAttributes:c,libraryType:u}),(0,l.createElement)("div",{className:"catf-dg-folders-setting "+("single_folder"===u?"catf-dg-folders-setting-disabled":""),style:{marginBottom:"16px"}},(0,l.createElement)(se,{label:(0,n.__)("Search scope","catfolders-document-gallery"),onChange:e=>c({searchScope:e}),options:v,selected:g,name:"searchScope",disabled:"single_folder"===u})),(0,l.createElement)("h3",null,(0,n.__)("Structure Display","catfolders-document-gallery")),(0,l.createElement)(re,{label:(0,n.__)("Breadcrumb","catfolders-document-gallery"),checked:f,onChange:e=>{c({showBreadCrumb:e})},disabled:"single_folder"==u}),(0,l.createElement)(re,{label:(0,n.__)("Nested Folders","catfolders-document-gallery"),checked:p,onChange:e=>{c({isNestedFolders:e})},disabled:"single_folder"==u})))),(0,l.createElement)(Z,{attributes:e,setAttributes:c,clientId:r}),(0,l.createElement)(B,{attributes:e,setAttributes:c,clientId:r}),(0,l.createElement)(S,{attributes:e,setAttributes:c,clientId:r,setNotice:h,topRef:C}))},save:()=>null})})();